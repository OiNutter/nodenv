#!/usr/bin/env node

// IntelliJ/WebStorm needs a npm package bundled with a particular node installation.
// Bundled npm package is detected as "/path/to/node/../lib/node_modules/npm/".
// For "$(nodenv root)/shims/node", it's "$(nodenv root)/lib/node_modules/npm/".

// To run a npm command, IntelliJ/WebStorm runs the main entry JavaScript file directly (npm/bin/npm-cli.js). Benefits:
// * It's possible to use a selected interpreter (not from $PATH), preventing possible issues when 'node' is
//   not found in $PATH due to configuration issues.
// * It allows to pass node options (--debug/v8-options) if needed. Though none are currently passed.

const nodenvRoot = require('path').resolve(__dirname, '../../../..')
process.env.NODENV_ROOT = nodenvRoot
require('child_process')
  .spawn(nodenvRoot + '/shims/npm', process.argv.slice(2), {env: process.env, stdio: 'inherit'})
  .on('close', process.exit)
